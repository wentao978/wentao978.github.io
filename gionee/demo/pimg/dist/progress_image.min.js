(function(){var temp=document.createElement;document.createElement=function(tagName){if(tagName=="img")return new Image;return temp.call(this,tagName)};var getter=function(){return this.__oriSrc};var setter=function(value){this.__oriSrc=value;var self=this;var protocol=value.substring(0,value.indexOf(":"));if(protocol=="http"||protocol=="https"||protocol==""){if(this._xhr==null){this._xhr=new XMLHttpRequest;this._xhr.responseType="arraybuffer";this._xhr.onabort=middleListener;this._xhr.onerror=middleListener;this._xhr.onloadend=middleListener;this._xhr.onloadstart=middleListener;this._xhr.onprogress=middleListener;this._xhr.ontimeout=middleListener;this._xhr.onload=function(){var blob=new Blob([self._xhr.response]);var url=URL.createObjectURL(blob);callOri(url);setTimeout(URL.revokeObjectURL,0,url)}}if(this._xhr.status!=XMLHttpRequest.UNSENT)this._xhr.abort();this._xhr.open("GET",value,true);this._xhr.send()}else{callOri(value)}function middleListener(evt){var newEvt=document.createEvent(evt.constructor["name"]);newEvt.initEvent(evt.type,evt.bubbles,evt.cancelable);var keys=Object.keys(evt["__proto__"]);for(var i in keys){var key=keys[i];Object.defineProperty(newEvt,key,{writable:false,value:evt[key]})}var callback=self["on"+newEvt.type];callback&&callback.call(self,newEvt);self.dispatchEvent(newEvt)}function callOri(value){delete Image.prototype["src"];self.src=value;Object.defineProperty(Image.prototype,"src",{configurable:true,get:getter,set:setter})}};Object.defineProperty(Image.prototype,"src",{configurable:true,get:getter,set:setter})})();